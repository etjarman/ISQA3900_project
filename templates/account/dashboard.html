{% extends "items/base.html" %}
{% block content %}
<h4>My Account</h4>

<form method="post" style="max-width:520px;margin-bottom:2rem">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Save changes</button>
  <a href="{% url 'password_change' %}" style="margin-left:1rem">Change password</a>
</form>

<h5>My postings</h5>
{% if my_items %}
  <div class="grid">
    {% for i in my_items %}
      <div class="card">
        {% if i.photo %}<img src="{{ i.photo.url }}" alt="{{ i.title }}" style="width:100%;height:160px;object-fit:cover;border-radius:8px;margin-bottom:.5rem">{% endif %}
        <h5><a href="{% url 'items:item_detail' i.pk %}">{{ i.title }}</a></h5>
        <p class="muted">{{ i.status }} &bull; {{ i.category.name }} &bull; {{ i.building|default:"" }}</p>
        <div style="display:flex;gap:.5rem;margin-top:.5rem">
          <a href="{% url 'items:item_update' i.pk %}">Edit</a>
          <form method="post" action="{% url 'items:item_delete' i.pk %}" onsubmit="return confirm('Delete this item?');">
            {% csrf_token %}<button type="submit" class="button-outline">Delete</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>You havenâ€™t posted anything yet. <a href="{% url 'items:item_create' %}">Post an item</a></p>
{% endif %}
{% endblock %}
